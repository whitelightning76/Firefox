// Restart item script for Firefox 60+ by Aris
//
// left-click on restart item: normal restart
// middle-click on restart item: restart + clear caches
// right-click on restart item: no special function
//
// based on 'addRestartButton.uc.js' script by Alice0775
// restart code from Classic Theme Restorer add-on
// invalidate caches from Session Saver add-on

var {Services} = Components.utils.import("resource://gre/modules/Services.jsm", {});
var appversion = parseInt(Services.appinfo.version);

var RestartMenuFileAppItems = {
  init: function() {

	var button_label = "Restart";
	
	try {
	  switch (document.getElementById("nav-bar").getAttribute("aria-label")) {
		case "Navigations-Symbolleiste": button_label = "Neustarten"; break;
		case "Панель навигации": button_label = "Перезапустить"; break;
	  }
	} catch(e) {}

	try {
	  if(appversion <= 62) restartitem_filemenu = document.createElement("menuitem");
	  else restartitem_filemenu = document.createXULElement("menuitem");
	  restartitem_filemenu.setAttribute("label", button_label);
	  restartitem_filemenu.setAttribute("id","fileMenu-restart-item");
	  restartitem_filemenu.setAttribute("key", "R");
	  restartitem_filemenu.setAttribute("insertbefore", "menu_FileQuitItem");
	  restartitem_filemenu.setAttribute("onclick", "if (event.button == 0) {RestartMenuFileAppItems.restartApp(false);} else if (event.button == 1) {RestartMenuFileAppItems.restartApp(true)};");
	  restartitem_filemenu.setAttribute("oncommand", "RestartMenuFileAppItems.restartApp(false);");

	  if(document.getElementById("menu_FileQuitItem").previousSibling.id != "fileMenu-restart-item" )
		document.getElementById("menu_FileQuitItem").parentNode.insertBefore(restartitem_filemenu,document.getElementById("menu_FileQuitItem"));
	} catch(e) {}

	try {
	  if(appversion <= 62) restartitem_appmenu = document.createElement("toolbarbutton");
	  else restartitem_appmenu = document.createXULElement("toolbarbutton");
	  restartitem_appmenu.setAttribute("label", button_label);
	  restartitem_appmenu.setAttribute("id","appMenu-restart-button");
	  restartitem_appmenu.setAttribute("class","subviewbutton subviewbutton-iconic");
	  restartitem_appmenu.setAttribute("key", "R");
	  restartitem_appmenu.setAttribute("insertbefore", "appMenu-quit-button");
	  restartitem_appmenu.setAttribute("onclick", "if (event.button == 0) {RestartMenuFileAppItems.restartApp(false);} else if (event.button == 1) {RestartMenuFileAppItems.restartApp(true)};");
	  restartitem_appmenu.setAttribute("oncommand", "RestartMenuFileAppItems.restartApp(false);");

	  if(document.getElementById("appMenu-quit-button").previousSibling.id != "appMenu-restart-button" )
		document.getElementById("appMenu-quit-button").parentNode.insertBefore(restartitem_appmenu,document.getElementById("appMenu-quit-button"));
	} catch(e) {}

	var sss = Components.classes["@mozilla.org/content/style-sheet-service;1"].getService(Components.interfaces.nsIStyleSheetService);

	// style button icon
	var uri = Services.io.newURI("data:text/css;charset=utf-8," + encodeURIComponent('\
	  \
	  #appMenu-restart-button {\
		list-style-image: url("data:image/png;base64,R0lGODlh3gH/AffqALzqh9HwrcLskrvphtDwrMPsk7npgsruoMnun83vpc3vpszvpeD1yKLhWcbtmv7//e/64rnpgb/rjcDrjt/1xcftmvH65qDhVdDwq+v527vphc/wqZXdQcDrj/D65cbtmbrphNbytpTdQO353+b30+f30/H75uH1yaHhV5rfSrjogOL2zO754JTdP5PdPu/648nuntjyuNTxsdz0wNz0wfD65OP2zcvuor7qi+j41+T2z57gUuL2y9XyteH2yq3lbKjjZNfyuOT2zrTneOn41+b30tfyt6vkadDwqtbytabjYMPslMHrkbjof5HcOsjunqfjYsHrj7HmdOP2zNLxr9PxsPP76vz++bbofLHmc+z53eX30fj98r3qidrzvff88c7vp5LcPZLcO+j41eT3z+f31Oz53OD1x6XiX7LmdZnfSarkaLTned/1xpPdP9TxsqjjY6zla8jtna/mcMzvo63lbaPiWp3gUN70xLbofen42JzfTpDcOZDcOLnpg7PneL/rjOX30L3qiPb8767lb5/gU4/bN6XiXbXne+r42ZvfTLfof73qiqbjYcTslvr99tXytKXiXpbeQ7Dmcdv0v9Lxruj41sruoaHhVrDmcsXslvz++pbeRPv++Z7gUbLndtTxs5LcPMXtmJ3gT/L76NnzvMTslZjeRtrzvPX87fn99I7bNvr99aTiXLXofJjeR9nzu5/hVMzvpLrpg/T87KHhWM7vqNPxsankZZHcO8jtnMHrkJfeRez53vn99bfofu764f3+/JzgTt30wrXnet71xPj985rfS8ftm/X87qPiW/b87ur42rPnd5bdQvf88NjzuqnkZvv+9/3++6TiXZneSPf98qnjZazkaqfjYa/lcK7lbvP76dvzvvT766vkaPv++JfeRtjzud30w/L756rkZ8Xtl5XdQpvfTY7bNf///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4RkEzOTBBMzA3MTUxMUU4ODg5MDhEMjQ2MzBFOUE0MyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4RkEzOTBBMjA3MTUxMUU4ODg5MDhEMjQ2MzBFOUE0MyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RDZFQzIyMzAwNzBGMTFFODlCRjFCNzJBNDBFRkE3QUUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDZFQzIyMzEwNzBGMTFFODlCRjFCNzJBNDBFRkE3QUUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PDs6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAf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"); /* icon / path to icon */ \
	  }\
	  #appMenu-restart-button .toolbarbutton-icon {\
		transform: scaleX(-1); /* icon mirroring */\
		color: var(--theme-reload-icon); /* icon color name/code */\
	  }\
	  \
	'), null, null);

	sss.loadAndRegisterSheet(uri, sss.AGENT_SHEET);
	
  },

  restartApp: function(clearcaches) {

	var cancelQuit = Components.classes["@mozilla.org/supports-PRBool;1"].createInstance(Components.interfaces.nsISupportsPRBool);
	var observerSvc = Components.classes["@mozilla.org/observer-service;1"].getService(Components.interfaces.nsIObserverService);

	if(clearcaches) {
	  Components.classes["@mozilla.org/xre/app-info;1"].getService(Components.interfaces.nsIXULRuntime).invalidateCachesOnRestart();
	}

	observerSvc.notifyObservers(cancelQuit, "quit-application-requested", "restart");

	if(cancelQuit.data) return false;

	Services.startup.quit(Services.startup.eRestart | Services.startup.eAttemptQuit);

  }

}

RestartMenuFileAppItems.init();

